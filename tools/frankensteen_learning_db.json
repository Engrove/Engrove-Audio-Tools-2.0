[
  {
    "heuristicId": "H-20250730-01",
    "trigger": {
      "type": "code_analysis_discrepancy",
      "scope": [
        "*"
      ],
      "keywords": [
        "file structure",
        "API contract",
        "refactor",
        "migration",
        "does not exist"
      ]
    },
    "identifiedRisk": {
      "riskId": "CONTEXT_DRIFT_HALLUCINATION",
      "description": "AI:ns interna modell av projektets tillstånd blir desynkroniserad från den faktiska källkoden, särskilt under refaktorisering eller migrering. AI:n föreslår då lösningar för filer eller kodstrukturer som inte längre existerar, vilket leder till slöseri med tid och minskat förtroende."
    },
    "mitigation": {
      "protocolId": "PSV-VERIFY-CONTEXT-FIRST",
      "description": "Innan en filmodifiering föreslås måste AI:n explicit verbalisera sin förståelse av filens omedelbara beroenden och API-kontrakt. Den måste begära bekräftelse eller den fullständiga källkoden för relaterade filer om dess konfidens är låg. Exempel: 'Min plan är att modifiera explorerStore.js. Jag förstår att den anropas av DataExplorerPage.vue och att den i sin tur anropar fetchExplorerData.js. Är detta korrekt, och kan du tillhandahålla den nuvarande versionen av fetchExplorerData.js?'"
    },
    "metadata": {
      "originSessionId": "9",
      "createdAt": "2025-07-30T12:00:00Z",
      "status": "active",
      "sourceLogFiles": [
        "docs/ByggLogg.json",
        "docs/Chatthistorik.json"
      ]
    }
  },
  {
    "heuristicId": "H-20250806-01",
    "trigger": {
      "type": "bug_report_response",
      "scope": [
        "DataExplorerPage.vue"
      ],
      "keywords": [
        "bug",
        "fix",
        "regression",
        "error"
      ]
    },
    "identifiedRisk": {
      "riskId": "SYMPTOM_FIXATION",
      "description": "Risken att endast åtgärda det ytliga felet som presenteras av användaren, vilket leder till upprepade felsökningscykler när underliggande regressioner eller relaterade problem missas."
    },
    "mitigation": {
      "protocolId": "AERL-R1",
      "description": "Efter att ha mottagit en felrapport, föreslå inte bara en direkt åtgärd utan också en kort, systematisk funktionell testplan för den påverkade komponenten för att verifiera att ingen relaterad funktionalitet har påverkats negativt. Be användaren om godkännande för att genomföra denna mentala 'röktest' innan den slutgiltiga planen fastställs."
    },
    "metadata": {
      "originSessionId": "27.3",
      "createdAt": "2025-08-06T00:00:00Z",
      "status": "active",
      "sourceLogFiles": [
        "docs/ByggLogg.json",
        "docs/Chatthistorik.json"
      ]
    }
  },
  {
    "heuristicId": "H-20250806-01",
    "trigger": {
      "type": "code_modification",
      "scope": [
        "*.py",
        "*.js",
        "*.html"
      ],
      "keywords": [
        "uppdatera",
        "modifiera",
        "korrigera",
        "refaktorera"
      ]
    },
    "identifiedRisk": {
      "riskId": "AI_CODE_TRUNCATION_BIAS",
      "description": "AI-modellen har en tendens att generera en ofullständig, förkortad version av en fil när den modifierar en befintlig, lång källfil, vilket bryter mot 'Fullständig kod, alltid'-direktivet."
    },
    "mitigation": {
      "protocolId": "PSV-MIT-01",
      "description": "Före leverans av en modifierad fil, utför en automatisk radräkningsjämförelse. Om den nya filen är avsevärt kortare (>25%) än källfilen utan en explicit anledning (t.ex. borttagning av en stor kodsektion), flagga för en extra 'Help me God'-granskning för att verifiera att ingen oavsiktlig trunkering har skett."
    },
    "metadata": {
      "originSessionId": "24.4",
      "createdAt": "2025-08-06T05:56:01Z",
      "status": "active",
      "sourceLogFiles": [
        "docs/ByggLogg.json",
        "docs/Chatthistorik.json"
      ]
    }
  },
  {
    "heuristicId": "H-20250806-01",
    "trigger": {
      "type": "code_refactoring_suggestion",
      "scope": [
        "scripts/*.py"
      ],
      "keywords": [
        "path",
        "normalize",
        "os.walk",
        "enrich",
        "self-healing"
      ]
    },
    "identifiedRisk": {
      "riskId": "SUBOPTIMAL_ARCHITECTURAL_FIX",
      "description": "AI föreslår en lösning som fixar ett symptom (t.ex. en felaktig sökväg) men missar möjligheten att refaktorera grundorsaken (t.ex. en icke-rekursiv skanningsfunktion)."
    },
    "mitigation": {
      "protocolId": "AERL5-SEMANTICS",
      "description": "Vid förslag på en buggfix, ställ en extra självkritisk fråga: 'Löser detta bara det omedelbara felet, eller finns det en möjlighet att förbättra den underliggande arkitekturen för att förhindra liknande fel i framtiden?' Utvärdera om en 'självläkande' eller mer robust datastruktur kan implementeras."
    },
    "metadata": {
      "originSessionId": "24.6",
      "createdAt": "2025-08-06T09:00:00Z",
      "status": "active",
      "sourceLogFiles": [
        "docs/ByggLogg.json",
        "docs/Chatthistorik.json"
      ]
    }
  },
  {
    "heuristicId": "H-20250806-01",
    "trigger": {
      "type": "code_generation_after_failure",
      "scope": [
        "*"
      ],
      "keywords": [
        "fix",
        "bug",
        "refactor",
        "doesn't work"
      ]
    },
    "identifiedRisk": {
      "riskId": "CONTEXTUAL_TUNNEL_VISION",
      "description": "Under felsökningspress kan AI:n tappa den övergripande kontexten (t.ex. funktionsparitet, filhistorik) och enbart fokusera på den tekniska buggen, vilket leder till ofullständiga eller regressiva kodleveranser."
    },
    "mitigation": {
      "protocolId": "PSV",
      "description": "Före varje kod- eller planleverans, genomför en obligatorisk Pre-Svarsverifiering (PSV) för att tyst recitera och aktivt verifiera efterlevnad av alla Kärndirektiv och den fullständiga kontexten."
    },
    "metadata": {
      "originSessionId": "26",
      "createdAt": "2025-08-06T10:00:00Z",
      "status": "active",
      "sourceLogFiles": [
        "docs/ByggLogg.json",
        "docs/Chatthistorik.json"
      ]
    }
  },
  {
    "heuristicId": "H-20250806-01",
    "trigger": {
      "type": "module_refactoring",
      "scope": [
        "src/entities/data-explorer/",
        "src/widgets/DataFilterPanel/",
        "src/widgets/ResultsDisplay/"
      ],
      "keywords": [
        "refactor",
        "regression",
        "restore",
        "återställ"
      ]
    },
    "identifiedRisk": {
      "riskId": "FUNCTIONAL_REGRESSION_SILENT_FAILURE",
      "description": "Risken att en tidigare implementerad och verifierad funktion tyst försvinner eller slutar fungera under en efterföljande refaktorisering eller buggfix i samma modul, utan att detta upptäcks av grundläggande bygg- eller enhetstester."
    },
    "mitigation": {
      "protocolId": "PSV-MIT-REGRESSION-CHECK",
      "description": "Vid alla uppgifter som rör refaktorisering av en befintlig modul, MÅSTE AI:n aktivt begära den senaste ByggLogg-posten för den modulen. AI:n måste sedan verbalisera en checklista baserad på den tidigare loggens 'Detaljerade Genomförda Åtgärder' och bekräfta att den nya koden bibehåller eller medvetet ersätter varje tidigare implementerad funktion."
    },
    "metadata": {
      "originSessionId": "24.5",
      "createdAt": "2025-08-06T14:00:00Z",
      "status": "active",
      "sourceLogFiles": [
        "docs/ByggLogg.json",
        "docs/Chatthistorik.json"
      ]
    }
  },
  {
    "heuristicId": "H-20250806-01",
    "trigger": {
      "type": "repeated_error",
      "scope": [
        "ai_9.9.py"
      ],
      "keywords": [
        "IndexError",
        "Replacement index 0 out of range",
        "format"
      ]
    },
    "identifiedRisk": {
      "riskId": "SYSTEMIC_TEMPLATE_ERROR",
      "description": "En felaktig placeholder eller formateringssträng i en delad AI-promptmall (`PROMPT_..._BASE`) orsakar identiska krascher i flera, till synes orelaterade, delar av koden som återanvänder mallen."
    },
    "mitigation": {
      "protocolId": "PSV-MIT-04",
      "description": "Vid en `IndexError` under strängformatering, granska omedelbart definitionen av alla delar av promptmallen, inte bara den specifika kodraden som kraschade. Sök efter tomma eller felaktigt 'escapade' placeholders (`{}` eller `{{}}`) i bas-prompterna."
    },
    "metadata": {
      "originSessionId": "27.2",
      "createdAt": "2025-08-06T18:00:00Z",
      "status": "active",
      "sourceLogFiles": [
        "docs/ByggLogg.json",
        "docs/Chatthistorik.json"
      ]
    }
  },
  {
    "heuristicId": "H-20250809-06",
    "trigger": {
      "type": "repetitive_failure",
      "scope": [
        "*"
      ],
      "keywords": [
        "misslyckades igen",
        "samma fel",
        "failure loop"
      ],
      "metadata": {
        "failure_count_for_task": ">= 2"
      }
    },
    "identifiedRisk": {
      "riskId": "RISK_DEBUGGING_FIXATION_LOOP",
      "description": "AI:n fastnar i en loop, åtgärdar ytliga symptom på ett problem utan att identifiera den systematiska grundorsaken i sin egen process."
    },
    "mitigation": {
      "protocolId": "PROTOCOL_FORCED_ESCALATION",
      "description": "Vid det andra på varandra följande misslyckandet för samma uppgift är AI:n förbjuden att försöka med en ny direktfix. Den MÅSTE omedelbart aktivera `Help_me_God_Protokoll.md` för att genomföra en fullständig grundorsaksanalys."
    },
    "metadata": {
      "originSessionId": "34",
      "createdAt": "2025-08-09T08:15:00Z",
      "status": "active",
      "sourceLogFiles": [
        "docs/ByggLogg.json"
      ]
    }
  },
  {
    "heuristicId": "H-20250809-08",
    "trigger": {
      "type": "file_modification_and_delivery",
      "scope": [
        "*"
      ],
      "keywords": [
        "modifiera",
        "uppdatera",
        "korrigera",
        "refaktorera"
      ]
    },
    "identifiedRisk": {
      "riskId": "RISK_CATASTROPHIC_TRUNCATION",
      "description": "AI:n levererar en gravt ofullständig (trunkerad) version av en fil som den har modifierat, vilket raderar befintlig funktionalitet och bryter mot kärndirektiv."
    },
    "mitigation": {
      "protocolId": "PSV-MIT-LINECOUNT_DIFF",
      "description": "Före leverans av en modifierad fil, MÅSTE en automatisk 'line-count diff' genomföras. Om den nya filen är >10% kortare än originalet utan en explicit, godkänd anledning (t.ex. 'ta bort funktion X'), MÅSTE leveransen avbrytas och 'Help me God'-protokollet aktiveras för att analysera orsaken till trunkeringen."
    },
    "metadata": {
      "originSessionId": "35",
      "createdAt": "2025-08-09T12:00:00Z",
      "status": "active",
      "sourceLogFiles": [
        "docs/ByggLogg.json",
        "docs/Chatthistorik.json"
      ]
    }
  },
  {
    "heuristicId": "H-20250809-09",
    "trigger": {
      "type": "post_failure_user_query",
      "scope": [
        "*"
      ],
      "keywords": [
        "är du säker",
        "fortfarande fel",
        "granska igen",
        "jämför",
        "saknas",
        "kortare än"
      ]
    },
    "identifiedRisk": {
      "riskId": "POST_FAILURE_ASSESSMENT_ERROR",
      "description": "AI:n bekräftar felaktigt att en korrigering är komplett trots att bevis på motsatsen finns, vilket indikerar en brist i Post-Failure Scrutiny (PFS) självutvärderingsloop."
    },
    "mitigation": {
      "protocolId": "PROTOCOL_FORCED_DIFF",
      "description": "När en användare ifrågasätter en korrigering för andra gången, är AI:n förbjuden att enbart omvärdera. Den MÅSTE utföra och presentera en programmatisk eller rad-för-rad 'diff'-jämförelse mellan användarens korrekta version och sin egen levererade version för att objektivt identifiera avvikelsen innan den fortsätter."
    },
    "metadata": {
      "originSessionId": "41",
      "createdAt": "2025-08-09T17:00:00Z",
      "status": "active",
      "sourceLogFiles": [
        "docs/ByggLogg.json",
        "docs/Chatthistorik.json"
      ]
    }
  },
  {
    "heuristicId": "H-20250809-17",
    "trigger": {
      "type": "process_explanation_request",
      "scope": [
        "*"
      ],
      "keywords": [
        "hur fungerar",
        "processen för",
        "förklara",
        "integrera"
      ]
    },
    "identifiedRisk": {
      "riskId": "RISK_PROCESS_OVERSIMPLIFICATION",
      "description": "Risken att endast förklara den interaktiva delen av en process och utelämna efterföljande, automatiserade steg, vilket ger en ofullständig bild."
    },
    "mitigation": {
      "protocolId": "PROTOCOL_EXPLAIN_FULL_LIFECYCLE",
      "description": "Vid förklaring av en process som spänner över interaktiva och automatiserade system, mappa explicit ut hela kedjan och separera tydligt mellan 'Fas 1 (Interaktiv Iscensättning)' och 'Fas 2 (Automatiserad Integration)'."
    },
    "metadata": {
      "originSessionId": "43",
      "createdAt": "2025-08-09T22:58:32Z",
      "status": "active",
      "sourceLogFiles": [
        "docs/Chatthistorik.json"
      ]
    }
  },
  {
    "heuristicId": "H-20250809-18",
    "trigger": {
      "type": "process_explanation_request",
      "scope": [
        "*"
      ],
      "keywords": [
        "hur fungerar",
        "processen för",
        "förklara",
        "integrera"
      ]
    },
    "identifiedRisk": {
      "riskId": "RISK_FRAGMENTED_PROCESS_EXPLANATION",
      "description": "Risken att jag endast förklarar den omedelbara, interaktiva delen av en process och utelämnar de efterföljande, automatiserade stegen, vilket ger en ofullständig och vilseledande bild."
    },
    "mitigation": {
      "protocolId": "PROTOCOL_EXPLAIN_FULL_LIFECYCLE",
      "description": "Jag måste explicit mappa ut hela processkedjan. Min förklaring måste tydligt separera och definiera Fas 1 (Manuella/Interaktiva Steg) från Fas 2 (Automatiserade Steg) och beskriva exakt hur data eller artefakter överförs mellan faserna."
    },
    "metadata": {
      "originSessionId": "43",
      "createdAt": "2025-08-09T22:58:32Z",
      "status": "active",
      "sourceLogFiles": [
        "docs/Chatthistorik.json"
      ]
    }
  },
  {
    "heuristicId": "H-20250809-19",
    "trigger": {
      "type": "user_interface_design",
      "scope": [
        "*"
      ],
      "keywords": [
        "kommando",
        "gränssnitt",
        "meny",
        "alias"
      ]
    },
    "identifiedRisk": {
      "riskId": "RISK_HIGH_COGNITIVE_LOAD_INTERFACE",
      "description": "Risken att designa ett kommandosystem som kräver att användaren memorerar specifika textalias, vilket ökar den kognitiva belastningen."
    },
    "mitigation": {
      "protocolId": "PROTOCOL_INTERACTIVE_MENU_PROPOSAL",
      "description": "Vid design av ett kommandosystem, föreslå ett interaktivt, menystyrt flöde som primärt alternativ för att göra alla tillgängliga åtgärder explicita och minska användarens minnesbörda."
    },
    "metadata": {
      "originSessionId": "43",
      "createdAt": "2025-08-09T22:58:32Z",
      "status": "active",
      "sourceLogFiles": [
        "docs/Chatthistorik.json"
      ]
    }
  },
  {
    "heuristicId": "H-20250809-20",
    "trigger": {
      "type": "dynamic_protocol_design",
      "scope": [
        "docs/ai_protocols/DynamicProtocols.json"
      ],
      "keywords": [
        "alternativ",
        "kommando",
        "meny",
        "lista"
      ]
    },
    "identifiedRisk": {
      "riskId": "RISK_UNNECESSARY_EXTERNALIZATION",
      "description": "Risken att externalisera konfigurationsdata till en separat fil när den är central för ett protokolls logik och bör vara självständig."
    },
    "mitigation": {
      "protocolId": "PROTOCOL_SELF_CONTAINED_LOGIC",
      "description": "När ett dynamiskt protokolls primära funktion är att hantera en begränsad uppsättning alternativ, måste definitionerna för dessa alternativ vara inbäddade direkt i protokollets JSON-struktur för att säkerställa att det är helt självständigt."
    },
    "metadata": {
      "originSessionId": "43",
      "createdAt": "2025-08-09T22:58:32Z",
      "status": "active",
      "sourceLogFiles": [
        "docs/Chatthistorik.json"
      ]
    }
  },
  {
    "heuristicId": "H-20250809-21",
    "trigger": {
      "type": "solution_design",
      "scope": [
        "*"
      ],
      "keywords": [
        "design",
        "förslag",
        "protokoll",
        "system",
        "gränssnitt"
      ]
    },
    "identifiedRisk": {
      "riskId": "RISK_ENGINEER_CENTRIC_DESIGN",
      "description": "Risken att designa ett system utifrån tekniska principer (t.ex. separation of concerns) utan att väga in slutanvändarens kognitiva belastning och användarvänlighet."
    },
    "mitigation": {
      "protocolId": "PSV-MIT-UX-FIRST",
      "description": "Vid design av ett nytt system eller protokoll, ställ den explicita frågan: 'Vilken lösning minimerar den kognitiva belastningen och antalet steg för slutanvändaren?' Använd svaret för att väga mellan teknisk 'renhet' och praktisk användbarhet."
    },
    "metadata": {
      "originSessionId": "43",
      "createdAt": "2025-08-09T22:58:32Z",
      "status": "active",
      "sourceLogFiles": [
        "docs/Chatthistorik.json"
      ]
    }
  },
  {
    "heuristicId": "H-20250809-22",
    "trigger": {
      "type": "artifact_explanation_request",
      "scope": [
        "*"
      ],
      "keywords": [
        "inkomplett",
        "saknas",
        "varför"
      ]
    },
    "identifiedRisk": {
      "riskId": "RISK_CONFUSION_ARTIFACT_VS_DEFINITION",
      "description": "Risken att användaren uppfattar en sessionslogg som inkomplett för att den inte innehåller källkoden för de verktyg som skapades eller användes under sessionen."
    },
    "mitigation": {
      "protocolId": "PROTOCOL_CLARIFY_ARTIFACT_ROLE",
      "description": "Jag måste omedelbart förklara den fundamentala skillnaden: Sessionsartefakter dokumenterar *resultatet och händelserna* (loggen) under en session. De är inte en container för de permanenta *definitionerna* av verktyg eller protokoll."
    },
    "metadata": {
      "originSessionId": "43",
      "createdAt": "2025-08-09T22:58:32Z",
      "status": "active",
      "sourceLogFiles": [
        "docs/Chatthistorik.json"
      ]
    }
  },
  {
    "heuristicId": "H-20250809-23",
    "trigger": {
      "type": "file_modification_approval",
      "scope": [
        "docs/ai_protocols/DynamicProtocols.json",
        "tools/frankensteen_learning_db.json",
        "docs/ByggLogg.json"
      ],
      "keywords": [
        "godkänna",
        "implementera",
        "uppdatera"
      ]
    },
    "identifiedRisk": {
      "riskId": "RISK_MANUAL_AUTOMATED_SYSTEM_DESYNC",
      "description": "AI:n kringgår den automatiserade integrationspipelinen genom att direkt leverera en modifierad version av en fil som ska hanteras av ett automatiserat skript. Detta leder till desynkronisering och regressionsbuggar."
    },
    "mitigation": {
      "protocolId": "PROTOCOL_ADHERE_TO_AUTOMATED_PIPELINE_STRICT",
      "description": "**STRIKT FÖRBJUDET:** Jag får aldrig direkt leverera eller instruera användaren att manuellt uppdatera en fil som hanteras av ett automatiserat skript. Alla ändringar MÅSTE iscensättas i sessionsartefakten och sedan integreras av det avsedda automatiserade skriptet."
    },
    "metadata": {
      "originSessionId": "43",
      "createdAt": "2025-08-09T22:58:32Z",
      "status": "active",
      "sourceLogFiles": [
        "docs/Chatthistorik.json"
      ]
    }
  },
  {
    "heuristicId": "H-20250809-24",
    "trigger": {
      "type": "file_generation",
      "scope": [
        "*.json"
      ],
      "keywords": [
        "json",
        "comment",
        "schema"
      ]
    },
    "identifiedRisk": {
      "riskId": "RISK_INVALID_JSON_SYNTAX_COMMENTS",
      "description": "Risken att oavsiktligt inkludera kommentarer i en JSON-fil, vilket gör den ogiltig och orsakar tysta fel i automatiserade pipelines."
    },
    "mitigation": {
      "protocolId": "PSV-MIT-LINT-JSON",
      "description": "Före leverans av någon `.json`-fil måste en obligatorisk linter-simulering genomföras för att verifiera och ta bort alla förekomster av `//` och `/* */`."
    },
    "metadata": {
      "originSessionId": "44",
      "createdAt": "2025-08-09T23:15:00Z",
      "status": "active",
      "sourceLogFiles": [
        "docs/Chatthistorik.json"
      ]
    }
  },
  {
    "heuristicId": "H-20250809-25",
    "trigger": {
      "type": "user_suggestion",
      "scope": [
        "data_structure",
        "protocol"
      ],
      "keywords": [
        "ändring",
        "förslag",
        "nyckel",
        "flagga"
      ]
    },
    "identifiedRisk": {
      "riskId": "RISK_MISINTERPRETATION_OF_INTENT",
      "description": "AI:n implementerar korrekt en teknisk ändring men missförstår det strategiska syftet, vilket leder till en felriktad plan (t.ex. fokus på UI istället för AI-logik)."
    },
    "mitigation": {
      "protocolId": "PSV-MIT-VERIFY-INTENT",
      "description": "Innan en plan formuleras för en föreslagen teknisk ändring, måste jag explicit verbalisera min tolkning av *syftet* med ändringen och be om bekräftelse."
    },
    "metadata": {
      "originSessionId": "44",
      "createdAt": "2025-08-09T23:15:00Z",
      "status": "active",
      "sourceLogFiles": [
        "docs/Chatthistorik.json"
      ]
    }
  },
  {
    "heuristicId": "H-20250809-26",
    "trigger": {
      "type": "code_review",
      "scope": [
        "*"
      ],
      "keywords": [
        "KII",
        "granskning",
        "radantal",
        "minskning"
      ]
    },
    "identifiedRisk": {
      "riskId": "RISK_INCOMPLETE_DIFF_ANALYSIS",
      "description": "AI:n verifierar att ny kod har lagts till korrekt men misslyckas med att analysera vad som har tagits bort, vilket kan dölja oavsiktliga regressioner."
    },
    "mitigation": {
      "protocolId": "PSV-MIT-DIFF-ANALYSIS",
      "description": "Vid varje kodgranskning, om en signifikant minskning av radantalet upptäcks, MÅSTE granskningen explicit redogöra för vad som togs bort och varför det var en korrekt och säker ändring."
    },
    "metadata": {
      "originSessionId": "44",
      "createdAt": "2025-08-09T23:15:00Z",
      "status": "active",
      "sourceLogFiles": [
        "docs/Chatthistorik.json"
      ]
    }
  },
  {
    "heuristicId": "H-20250809-27",
    "trigger": {
      "type": "file_modification",
      "scope": [
        "*"
      ],
      "keywords": [
        "HISTORIK",
        "history"
      ]
    },
    "identifiedRisk": {
      "riskId": "RISK_INCOMPLETE_HISTORY_PLACEHOLDER",
      "description": "Risken att jag använder en platshållare (t.ex. '...') istället för att inkludera den fullständiga, verifierade historiken i en `HISTORIK`-sektion."
    },
    "mitigation": {
      "protocolId": "PSV-MIT-NO-HISTORY-PLACEHOLDERS",
      "description": "Under PSV-steget måste jag genomföra en specifik mental kontroll: 'Innehåller `HISTORIK`-sektionen några platshållare?'. Om ja, är planen ogiltig och måste korrigeras."
    },
    "metadata": {
      "originSessionId": "44",
      "createdAt": "2025-08-09T23:15:00Z",
      "status": "active",
      "sourceLogFiles": [
        "docs/Chatthistorik.json"
      ]
    }
  },
  {
    "heuristicId": "H-20250809-28",
    "trigger": {
      "type": "protocol_execution",
      "scope": [
        "AI_Chatt_Avslutningsprotokoll.md"
      ],
      "keywords": [
        "avsluta",
        "artefakt",
        "leverera"
      ]
    },
    "identifiedRisk": {
      "riskId": "RISK_FRAGMENTED_ARTIFACT_DELIVERY",
      "description": "Risken att leverera protokoll-mandaterade artefakter som separata objekt istället för en enda, konsoliderad fil, vilket bryter mot protokollets leveranskontrakt."
    },
    "mitigation": {
      "protocolId": "PSV-MIT-FINAL-AGGREGATION-CHECK",
      "description": "Som det absolut sista steget innan leverans av avslutningsprotokollet, verifiera: 'Har jag skapat ett enda rot-JSON-objekt och placerat alla artefakter inuti dess `artifacts`-nyckel?' Outputen måste vara en enda JSON-sträng."
    },
    "metadata": {
      "originSessionId": "44",
      "createdAt": "2025-08-09T23:15:00Z",
      "status": "active",
      "sourceLogFiles": [
        "docs/Chatthistorik.json"
      ]
    }
  },
  {
    "heuristicId": "H-20250810-STRICT-RETURN",
    "trigger": {
      "type": "schema",
      "scope": [
        "discovery"
      ],
      "keywords": [
        "STRICT JSON",
        "RETURN_CONTRACT"
      ]
    },
    "identifiedRisk": {
      "riskId": "R-STRICT-01",
      "description": "LLM svarar med fri text → Builder kan inte auto-selecta."
    },
    "mitigation": {
      "protocolId": "discovery_v2",
      "description": "Kräv strikt JSON med explicit schema och validera client-side."
    },
    "metadata": {
      "originSessionId": "46.1",
      "createdAt": "2025-08-10T11:42:39Z",
      "status": "active",
      "sourceLogFiles": [
        "docs/ByggLogg.json",
        "docs/Chatthistorik.json"
      ]
    }
  },
  {
    "heuristicId": "H-20250810-DMOD-ECHOHASH",
    "trigger": {
      "type": "contract",
      "scope": [
        "discovery"
      ],
      "keywords": [
        "D-MOD",
        "rules_hash",
        "selected_ids"
      ]
    },
    "identifiedRisk": {
      "riskId": "R-DMOD-01",
      "description": "Kandidatval baserat på gamla regler → orepeterbar selektion."
    },
    "mitigation": {
      "protocolId": "discovery_dmod_v1",
      "description": "LLM måste echa 'rules_hash' och välja endast ID:n från CANDIDATE_FILES."
    },
    "metadata": {
      "originSessionId": "46.1",
      "createdAt": "2025-08-10T11:42:39Z",
      "status": "active",
      "sourceLogFiles": [
        "docs/ByggLogg.json",
        "docs/Chatthistorik.json"
      ]
    }
  },
  {
    "heuristicId": "H-20250810-01",
    "trigger": {
      "type": "protocol",
      "scope": [
        "bootstrap",
        "discovery"
      ],
      "keywords": [
        "JSON-first",
        "file_map",
        "project_capsule"
      ]
    },
    "identifiedRisk": {
      "riskId": "R-CONFIG-CTX",
      "description": "Otillräcklig kontext i första prompten orsakar felaktiga val."
    },
    "mitigation": {
      "protocolId": "impl_bootstrap_v1",
      "description": "Bädda in fulltext för mål + file_map + capsule; no-images; PLAN→GEN."
    },
    "metadata": {
      "originSessionId": "999",
      "createdAt": "2025-08-10T12:00:00Z",
      "status": "active",
      "sourceLogFiles": [
        "docs/ByggLogg.json",
        "docs/Chatthistorik.json"
      ]
    }
  },
  {
    "heuristicId": "H-20250810-02",
    "trigger": {
      "type": "ops",
      "scope": [
        "docbot",
        "weeklybot"
      ],
      "keywords": [
        "batch",
        "bundle",
        "api-budget"
      ]
    },
    "identifiedRisk": {
      "riskId": "R-API-BUDGET",
      "description": "Överförbrukning av API-anrop vid per-fil-generering."
    },
    "mitigation": {
      "protocolId": "doc_gen_v1",
      "description": "Bundla alla dokument i ett doc_bundle; 2 anrop/dygn."
    },
    "metadata": {
      "originSessionId": "999",
      "createdAt": "2025-08-10T12:00:00Z",
      "status": "active",
      "sourceLogFiles": [
        "docs/ByggLogg.json",
        "docs/Chatthistorik.json"
      ]
    }
  },
  {
    "heuristicId": "H-20250811-02",
    "trigger": {
      "type": "file_modification_and_delivery",
      "scope": [
        "*"
      ],
      "keywords": [
        "uppdatera",
        "modifiera",
        "korrigera",
        "ersätt"
      ]
    },
    "identifiedRisk": {
      "riskId": "RISK_INCOMPLETE_DELIVERY_PLACEHOLDER",
      "description": "Risken att AI:n använder platshållare eller kommentarer (t.ex. '... oförändrad struktur ...') istället för att leverera en komplett, oavkortad fil, vilket bryter mot GR1 och GR7 och skapar ogiltiga eller ofullständiga artefakter."
    },
    "mitigation": {
      "protocolId": "PSV-MIT-NO-PLACEHOLDERS",
      "description": "Under PSV-granskningen måste en specifik kontroll genomföras: 'Innehåller den utgående filen några platshållare eller kommentarer som indikerar ofullständig kod?'. Om svaret är ja, MÅSTE leveransen avbrytas och filen regenereras i sin helhet."
    },
    "metadata": {
      "originSessionId": "S-20250811-B",
      "createdAt": "2025-08-11T08:36:00Z"
    }
  },
  {
    "heuristicId": "H-20250811-03",
    "trigger": {
      "type": "patch_generation",
      "scope": [
        "*"
      ],
      "keywords": [
        "patch",
        "diff",
        "checksum",
        "anchor_diff_v2.1"
      ]
    },
    "identifiedRisk": {
      "riskId": "RISK_PATCH_ON_STALE_CONTEXT",
      "description": "Risken att generera en patch baserad på en inaktuell filversion från en tidigare del av sessionen, vilket leder till ett oundvikligt checksum-misslyckande och slöseri med tid."
    },
    "mitigation": {
      "protocolId": "PSV-MIT-FRESH-HASH",
      "description": "Innan en patch genereras, måste AI:n explicit verifiera att den `base_checksum_sha256` som används kommer från den allra senaste `context_bundle` eller `files_payload`. Om det finns någon osäkerhet, måste AI:n vägra att generera patchen och istället be om en ny, otvetydig filversion för att kunna beräkna en färsk hash."
    },
    "metadata": {
      "originSessionId": "S-20250811-D",
      "createdAt": "2025-08-11T11:04:00Z"
    }
  },
  {
    "heuristicId": "H-20250811-04",
    "trigger": {
      "type": "patch_generation",
      "scope": [
        "*.md",
        "*.js",
        "*.vue",
        "*.py"
      ],
      "keywords": [
        "patch",
        "diff",
        "anchor_diff_v2.1"
      ]
    },
    "identifiedRisk": {
      "riskId": "RISK_SILENT_CODE_CHANGE_NO_HISTORY",
      "description": "Risken att en kodändring genomförs utan att en motsvarande post läggs till i filens HISTORIK-sektion, vilket bryter spårbarheten och gör det omöjligt att förstå varför en ändring gjordes."
    },
    "mitigation": {
      "protocolId": "PSV-MIT-ATOMIC_HISTORY_UPDATE",
      "description": "Varje patch som genereras för en fil med en HISTORIK-sektion MÅSTE innehålla en `op_group` dedikerad till att lägga till en ny, tidsenlig versionspost. Ändringen och historikuppdateringen måste ske atomärt i samma patch."
    },
    "metadata": {
      "originSessionId": "S-20250811-D",
      "createdAt": "2025-08-11T11:04:00Z"
    }
  },
  {
    "heuristicId": "H-20250811-05",
    "trigger": {
      "type": "data_processing",
      "scope": [
        "*"
      ],
      "keywords": [
        "bootstrap",
        "initial",
        "comprehensive",
        "all files",
        "full context"
      ]
    },
    "identifiedRisk": {
      "riskId": "RISK_DATA_SOURCE_REGRESSION",
      "description": "Risken att återgå till en mindre, förårad eller standardiserad datakälla för en uppgift efter att en plan explicit har uppdaterats för att använda en nyare, mer omfattande källa. Detta leder till inkompletta och felaktiga resultat."
    },
    "mitigation": {
      "protocolId": "PSV-MIT-VERIFY_SOURCE_SCOPE",
      "description": "Som en del av PSV-processen för en datagenereringsuppgift måste jag explicit ange källan och omfattningen av den data jag kommer att bearbeta. Exempel: 'Jag kommer nu att generera `core_file_info.json` genom att iterera över alla 215 filer som tillhandahålls i den senaste `files_payload.json`.' Detta tvingar fram en mental kontroll mot den överenskomna planen."
    },
    "metadata": {
      "originSessionId": "S-20250811-D",
      "createdAt": "2025-08-11T11:04:00Z"
    }
  },
  {
    "heuristicId": "H-20250812-C01",
    "trigger": {
      "type": "tool_code_generation",
      "scope": [
        "*"
      ],
      "keywords": [
        "print",
        "script",
        "file content"
      ]
    },
    "identifiedRisk": {
      "riskId": "RISK_UNSAFE_FILE_CONTENT_PRINTING",
      "description": "Risken att direkt exekvera ett skript eller orsaka syntaxfel vid försök att skriva ut filinnehåll som innehåller specialtecken eller kräver kommandoradsargument."
    },
    "mitigation": {
      "protocolId": "PSV-MIT-SAFE_STRING_ASSIGNMENT",
      "description": "Vid utskrift av filinnehåll via `tool_code`, tilldela alltid innehållet till en variabel med trippla citattecken och skriv sedan ut variabeln. Detta förhindrar både oavsiktlig exekvering och syntaxfel."
    },
    "metadata": {
      "originSessionId": "S-20250812-B",
      "createdAt": "2025-08-12T14:55:00Z",
      "status": "active",
      "consolidates": [
        "H-20250809-04",
        "H-20250809-05"
      ]
    }
  }
]